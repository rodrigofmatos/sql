DROP TABLE [Mbs].[dbo].[RECEITASDRE]

CREATE TABLE [Mbs].[dbo].[RECEITASDRE](
	[BASE] [varchar](50) NULL,
	[EMPRESA] [varchar](50) NULL,
	[TABELA] [varchar](50) NULL,
	[BPLID] [int] NULL,
	[BPLNAME] [nvarchar](100) NULL,
	[TRANSCODE] [nvarchar](10) NULL,
	[VATREGNUM] [nvarchar](50) NULL,
	[TRANSACAO] [int] NULL,
	[NFNUM] [nvarchar](20) NULL,
	[TRANSTYPE] [nvarchar](40) NULL,
	[REFDATE] [NVARCHAR](20) NULL,
	[NIVEL3] [NVARCHAR](20) NULL,
	[NIVEL2] [NVARCHAR](20) NULL,
	[NIVEL1] [NVARCHAR](20) NULL,
	[NIVEL0] [NVARCHAR](20) NULL,
	[ACCTNAME] [NVARCHAR](100) NULL,
	[BASEREF] [nvarchar](20) NULL,
	[SYSTOTAL] [numeric](20, 6) NULL,
	[LINE_ID] [int] NULL,
	[ACCOUNT] [nvarchar](20) NULL,
	[DEBIT] [numeric](20, 6) NULL,
	[CREDIT] [numeric](20, 6) NULL,
	[CONTRAACT] [nvarchar](20) NULL,
	[SHORTNAME] [nvarchar](20) NULL,
	[PROJETO] [nvarchar](20) NULL,
	[LINEMEMO] [nvarchar](100) NULL,
	[DEBCRED] [char](1) NULL,
	[ItemCode] [varchar](10) NULL,
	[DSCRIPTION] [nvarchar](100) NULL,
	[QUANTITY] [numeric](20, 6) NULL,
	[LINETOTAL] [numeric](20, 6) NULL,
	[CANCELED] [char](1) NULL,
	[RESULTADO] [varchar](5) NULL,
	[CRIADOR] [char](6) NULL,
	[USUARIO] [nvarchar](100) NULL,
	[CLIENTECOD] [nvarchar](20) NULL,
	[CLIENTENOME] [nvarchar](100) NULL,
	[CATEGORIA] [nvarchar](10) NULL,
	[CONTAPN_COD] [nvarchar](20) NULL,
	[CONTAPN_NOME] [nvarchar](100) NULL,
	[SEGMENTO] [nvarchar](20) NULL,
	[VENDEDOR] [nvarchar](100) NULL,
	[SUPERVISOR] [nvarchar](100) NULL

) ON [PRIMARY]

INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOCHUACHUA' AS BASE,
		'CHUACHUA' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''),
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription,
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOCHUACHUA..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOCHUACHUA..JDT1 INNER JOIN SBOCHUACHUA..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOCHUACHUA..OJDT o INNER JOIN 
		SBOCHUACHUA..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOCHUACHUA..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOCHUACHUA..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOCHUACHUA..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOCHUACHUA..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOCHUACHUA..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOCHUACHUA..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOCHUACHUA..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOCHUACHUA..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOCHUACHUA..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOEmpLREZENDE' AS BASE,
		'EmpLREZENDE' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''),
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOEmpLREZENDE..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOEmpLREZENDE..JDT1 INNER JOIN SBOEmpLREZENDE..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOEmpLREZENDE..OJDT o INNER JOIN 
		SBOEmpLREZENDE..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOEmpLREZENDE..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOEmpLREZENDE..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOEmpLREZENDE..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOEmpLREZENDE..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOEmpLREZENDE..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOEmpLREZENDE..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOEmpLREZENDE..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOEmpLREZENDE..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOEmpLREZENDE..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOEMPREENDIMENTOSRZ' AS BASE,
		'EMPREENDIMENTOSRZ' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''),
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOEMPREENDIMENTOSRZ..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOEMPREENDIMENTOSRZ..JDT1 INNER JOIN SBOEMPREENDIMENTOSRZ..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOEMPREENDIMENTOSRZ..OJDT o INNER JOIN 
		SBOEMPREENDIMENTOSRZ..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOEMPREENDIMENTOSRZ..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOEMPREENDIMENTOSRZ..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOEMPREENDIMENTOSRZ..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOEMPREENDIMENTOSRZ..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOEMPREENDIMENTOSRZ..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOEMPREENDIMENTOSRZ..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOEMPREENDIMENTOSRZ..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOEMPREENDIMENTOSRZ..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOEMPREENDIMENTOSRZ..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)
		
		
INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOEMPREENDIMENTOSSM' AS BASE,
		'EMPREENDIMENTOSSM' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''),
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOEMPREENDIMENTOSSM..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOEMPREENDIMENTOSSM..JDT1 INNER JOIN SBOEMPREENDIMENTOSSM..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOEMPREENDIMENTOSSM..OJDT o INNER JOIN 
		SBOEMPREENDIMENTOSSM..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOEMPREENDIMENTOSSM..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOEMPREENDIMENTOSSM..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOEMPREENDIMENTOSSM..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOEMPREENDIMENTOSSM..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOEMPREENDIMENTOSSM..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOEMPREENDIMENTOSSM..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOEMPREENDIMENTOSSM..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOEMPREENDIMENTOSSM..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOEMPREENDIMENTOSSM..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)
		
INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOINFINIX1' AS BASE,
		'INFINIX1' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''),
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOINFINIX1..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOINFINIX1..JDT1 INNER JOIN SBOINFINIX1..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOINFINIX1..OJDT o INNER JOIN 
		SBOINFINIX1..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOINFINIX1..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOINFINIX1..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOINFINIX1..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOINFINIX1..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOINFINIX1..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOINFINIX1..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOINFINIX1..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOINFINIX1..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOINFINIX1..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)
		
INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOINFINIX2' AS BASE,
		'INFINIX2' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''),
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOINFINIX2..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOINFINIX2..JDT1 INNER JOIN SBOINFINIX2..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOINFINIX2..OJDT o INNER JOIN 
		SBOINFINIX2..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOINFINIX2..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOINFINIX2..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOINFINIX2..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOINFINIX2..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOINFINIX2..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOINFINIX2..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOINFINIX2..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOINFINIX2..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOINFINIX2..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)

INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOA7' AS BASE,
		'A7' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''),
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOA7..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOA7..JDT1 INNER JOIN SBOA7..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOA7..OJDT o INNER JOIN 
		SBOA7..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOA7..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOA7..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOA7..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOA7..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOA7..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOA7..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOA7..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOA7..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOA7..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBODL' AS BASE,
		'DL' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBODL..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBODL..JDT1 INNER JOIN SBODL..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBODL..OJDT o INNER JOIN 
		SBODL..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBODL..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBODL..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBODL..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBODL..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBODL..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBODL..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBODL..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBODL..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBODL..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOEQUILIBRIUM' AS BASE,
		'EQ' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOEQUILIBRIUM..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOEQUILIBRIUM..JDT1 INNER JOIN SBOEQUILIBRIUM..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOEQUILIBRIUM..OJDT o INNER JOIN 
		SBOEQUILIBRIUM..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOEQUILIBRIUM..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOEQUILIBRIUM..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOEQUILIBRIUM..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOEQUILIBRIUM..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOEQUILIBRIUM..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOEQUILIBRIUM..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOEQUILIBRIUM..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOEQUILIBRIUM..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOEQUILIBRIUM..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)



INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOBELACARIOCA' AS BASE,
		'BC' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription,
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 132 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOGDSMARCAS..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOGDSMARCAS..JDT1 INNER JOIN SBOGDSMARCAS..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOGDSMARCAS..OJDT o INNER JOIN 
		SBOGDSMARCAS..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOGDSMARCAS..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOGDSMARCAS..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOGDSMARCAS..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOGDSMARCAS..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOGDSMARCAS..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOGDSMARCAS..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOGDSMARCAS..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOGDSMARCAS..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOGDSMARCAS..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)



INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOGDSMARCASEU' AS BASE,
		'EU' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOGDSMARCASEU..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOGDSMARCASEU..JDT1 INNER JOIN SBOGDSMARCASEU..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOGDSMARCASEU..OJDT o INNER JOIN 
		SBOGDSMARCASEU..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOGDSMARCASEU..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOGDSMARCASEU..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOGDSMARCASEU..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOGDSMARCASEU..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOGDSMARCASEU..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOGDSMARCASEU..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOGDSMARCASEU..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOGDSMARCASEU..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOGDSMARCASEU..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOINNOVABR' AS BASE,
		'IP' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOINNOVABR..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOINNOVABR..JDT1 INNER JOIN SBOINNOVABR..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOINNOVABR..OJDT o INNER JOIN 
		SBOINNOVABR..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOINNOVABR..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOINNOVABR..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOINNOVABR..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOINNOVABR..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOINNOVABR..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOINNOVABR..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOINNOVABR..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOINNOVABR..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOINNOVABR..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOINNOVALAB' AS BASE,
		'IL' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOINNOVALAB..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOINNOVALAB..JDT1 INNER JOIN SBOINNOVALAB..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOINNOVALAB..OJDT o INNER JOIN 
		SBOINNOVALAB..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOINNOVALAB..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOINNOVALAB..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOINNOVALAB..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOINNOVALAB..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOINNOVALAB..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOINNOVALAB..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOINNOVALAB..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOINNOVALAB..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOINNOVALAB..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOINNOVAPA' AS BASE,
		'PA' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOINNOVAPA..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOINNOVAPA..JDT1 INNER JOIN SBOINNOVAPA..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOINNOVAPA..OJDT o INNER JOIN 
		SBOINNOVAPA..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOINNOVAPA..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOINNOVAPA..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOINNOVAPA..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOINNOVAPA..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOINNOVAPA..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOINNOVAPA..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOINNOVAPA..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOINNOVAPA..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOINNOVAPA..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOLCA' AS BASE,
		'LC' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOLCA..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOLCA..JDT1 INNER JOIN SBOLCA..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOLCA..OJDT o INNER JOIN 
		SBOLCA..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOLCA..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOLCA..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOLCA..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOLCA..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOLCA..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOLCA..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOLCA..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOLCA..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOLCA..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)



INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOLICITAACAO' AS BASE,
		'LI' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 102 OR R.GROUPCODE = 103) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOLICITAACAO..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOLICITAACAO..JDT1 INNER JOIN SBOLICITAACAO..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOLICITAACAO..OJDT o INNER JOIN 
		SBOLICITAACAO..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOLICITAACAO..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOLICITAACAO..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOLICITAACAO..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOLICITAACAO..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOLICITAACAO..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOLICITAACAO..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOLICITAACAO..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOLICITAACAO..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOLICITAACAO..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOML' AS BASE,
		'ML' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOML..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOML..JDT1 INNER JOIN SBOML..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOML..OJDT o INNER JOIN 
		SBOML..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOML..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOML..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOML..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOML..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOML..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOML..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOML..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOML..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOML..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)



INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOMW' AS BASE,
		'MW' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOMW..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOMW..JDT1 INNER JOIN SBOMW..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOMW..OJDT o INNER JOIN 
		SBOMW..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOMW..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOMW..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOMW..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOMW..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOMW..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOMW..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOMW..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOMW..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOMW..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)



INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBONUTGYNMATRIZ' AS BASE,
		'NH' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 118) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBONUTGYNMATRIZ..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBONUTGYNMATRIZ..JDT1 INNER JOIN SBONUTGYNMATRIZ..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBONUTGYNMATRIZ..OJDT o INNER JOIN 
		SBONUTGYNMATRIZ..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBONUTGYNMATRIZ..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBONUTGYNMATRIZ..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBONUTGYNMATRIZ..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBONUTGYNMATRIZ..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBONUTGYNMATRIZ..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBONUTGYNMATRIZ..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBONUTGYNMATRIZ..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBONUTGYNMATRIZ..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBONUTGYNMATRIZ..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)



INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBONUTRIEXIND' AS BASE,
		'NT' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBONUTRIEXIND..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBONUTRIEXIND..JDT1 INNER JOIN SBONUTRIEXIND..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBONUTRIEXIND..OJDT o INNER JOIN 
		SBONUTRIEXIND..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBONUTRIEXIND..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBONUTRIEXIND..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBONUTRIEXIND..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBONUTRIEXIND..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBONUTRIEXIND..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBONUTRIEXIND..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBONUTRIEXIND..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBONUTRIEXIND..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBONUTRIEXIND..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)



INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOORALLS' AS BASE,
		'OR' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOORALLS..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOORALLS..JDT1 INNER JOIN SBOORALLS..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOORALLS..OJDT o INNER JOIN 
		SBOORALLS..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOORALLS..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOORALLS..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOORALLS..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOORALLS..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOORALLS..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOORALLS..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOORALLS..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOORALLS..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOORALLS..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBORZLABORATORIOS' AS BASE,
		'RL' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBORZLABORATORIOS..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBORZLABORATORIOS..JDT1 INNER JOIN SBORZLABORATORIOS..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBORZLABORATORIOS..OJDT o INNER JOIN 
		SBORZLABORATORIOS..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBORZLABORATORIOS..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBORZLABORATORIOS..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBORZLABORATORIOS..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBORZLABORATORIOS..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBORZLABORATORIOS..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBORZLABORATORIOS..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBORZLABORATORIOS..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBORZLABORATORIOS..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBORZLABORATORIOS..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOVIDAFARMA' AS BASE,
		'IN' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOVIDAFARMA..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOVIDAFARMA..JDT1 INNER JOIN SBOVIDAFARMA..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOVIDAFARMA..OJDT o INNER JOIN 
		SBOVIDAFARMA..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOVIDAFARMA..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOVIDAFARMA..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOVIDAFARMA..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOVIDAFARMA..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOVIDAFARMA..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOVIDAFARMA..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOVIDAFARMA..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOVIDAFARMA..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOVIDAFARMA..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOZ9' AS BASE,
		'Z9' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription,
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOZ9..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOZ9..JDT1 INNER JOIN SBOZ9..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOZ9..OJDT o INNER JOIN 
		SBOZ9..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOZ9..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOZ9..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOZ9..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOZ9..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOZ9..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOZ9..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOZ9..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOZ9..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOZ9..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


INSERT INTO MBS..RECEITASDRE
	SELECT
		'SBOVZ' AS BASE,
		'VZ' AS EMPRESA,
		'OJDT - LANCAMENTO MANUAL' AS TABELA,
		I.BPLID, 
		I.BPLNAME, COALESCE(O.TRANSCODE,'') AS TRANSCODE, 
		I.VATREGNUM,
		o.TRANSID, COALESCE(O.REF1,''), 
		O.TRANSTYPE, 
		FORMAT(O.REFDATE,'yyyy/MM') AS REFDATE, 
		A.Segment_9 AS NIVEL3,
		A.Segment_2 AS NIVEL2,
		A.Segment_1 AS NIVEL1,
		A.Segment_0 AS NIVEL0,
		UPPER(A.AcctName) AS ACCTNAME,
		O.BASEREF, 
		O.SYSTOTAL, 
		I.LINE_ID, 
		I.ACCOUNT, 
		-I.SYSDEB AS DEBIT, 
		I.SYSCRED, 
		(CASE WHEN (I.CONTRAACT LIKE 'F%' OR I.CONTRAACT LIKE 'C%') THEN I.ACCOUNT ELSE I.CONTRAACT END) CONTRAACT, 
		(CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) SHORTNAME, 
		I.PROJECT, 
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) LINEMEMO,
		I.DEBCRED,
		'9999999' AS ItemCode,
		LEFT(REPLACE(REPLACE(REPLACE(COALESCE(I.LINEMEMO,''),CHAR(13),' | '),CHAR(10),' | '),CHAR(9),' | '),100) Dscription, 
		1 AS QUANTITY,
		(-I.SYSDEB + I.SYSCRED) AS LineTotal, 
		'N' AS CANCELED, 
		'DRE' AS RESULTADO,
		 COALESCE(I.EXPUUID,'SAP') AS CRIADOR,
		 UPPER((U.USER_CODE + ' - ' + U.U_NAME)) AS USUARIO, 
		 CASE WHEN R.CARDCODE IS NOT NULL THEN R.CARDCODE ELSE '#NOCODE#' END AS CLIENTECOD, 
		 CASE WHEN R.CARDNAME IS NOT NULL THEN R.CARDNAME ELSE '#NONAME#' END AS CLIENTENOME, 
		 CASE WHEN (R.GROUPCODE = 107 OR R.GROUPCODE = 115) THEN 1 ELSE R.GROUPCODE END AS CATEGORIA
		 ,COALESCE((SELECT TOP 1 ACCOUNT FROM SBOVZ..JDT1 WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NOCODEPN#') AS CONTAPN_COD
		 ,COALESCE((SELECT TOP 1 UPPER(T.AcctName) FROM SBOVZ..JDT1 INNER JOIN SBOVZ..OACT T ON T.AcctCode COLLATE DATABASE_DEFAULT = ACCOUNT WHERE LEFT(ACCOUNT,1) IN ('1','2') AND i.BaseRef = SOURCEID AND TRANSID = i.TRANSID),'#NONAMEPN#') AS CONTAPN_NOME
		 ,'COMUM' AS SEGMENTO
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN C1.NAME IS NULL AND C2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN C1.NAME
			ELSE C2.NAME
		  END VENDEDOR
		 ,CASE
			WHEN V.SLPCODE = -1 OR N.SLPCODE = -1 THEN 'NENHUM' 
			WHEN H1.NAME IS NULL AND H2.NAME IS NULL THEN 'DESPESA'
			WHEN O.TRANSTYPE = 13 THEN H1.NAME
			ELSE H2.NAME
		  END SUPERVISOR
	FROM				
		SBOVZ..OJDT o INNER JOIN 
		SBOVZ..JDT1 i on i.TRANSID = o.TRANSID INNER JOIN 
		SBOVZ..OUSR U ON U.USERID = O.USERSIGN LEFT JOIN
		SBOVZ..OACT A ON A.AcctCode COLLATE DATABASE_DEFAULT = (CASE WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.ACCOUNT ELSE I.SHORTNAME END) LEFT JOIN
		SBOVZ..OCRD R ON R.CARDCODE = (CASE WHEN (I.SHORTNAME NOT LIKE 'F%' AND I.SHORTNAME NOT LIKE 'C%' AND I.ContraAct NOT LIKE 'F%' AND I.ContraAct NOT LIKE 'C%' AND I.ACCOUNT NOT LIKE 'F%' AND I.ACCOUNT NOT LIKE 'C%') THEN (CASE WHEN ((RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'F%' AND (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) NOT LIKE 'C%') THEN NULL ELSE (RTRIM(LTRIM(RIGHT(I.LINEMEMO,7)))) END) WHEN (I.SHORTNAME LIKE 'F%' OR I.SHORTNAME LIKE 'C%') THEN I.SHORTNAME ELSE I.ContraAct END) LEFT JOIN
		SBOVZ..OINV V ON V.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 13 LEFT JOIN
		SBOVZ..ORIN N ON N.DOCENTRY = O.BASEREF AND O.TRANSTYPE = 14 LEFT JOIN
		SBOVZ..[@FT_ORCA] c1 ON C1.CODE = V.SLPCODE LEFT JOIN
		SBOVZ..[@FT_ORCA] c2 ON C2.CODE = N.SLPCODE LEFT JOIN
		SBOVZ..[@FT_OHRQ] h1 ON c1.[U_Hierarquia] = h1.code LEFT JOIN
		SBOVZ..[@FT_OHRQ] h2 ON c2.[U_Hierarquia] = h2.code 
	WHERE 
		YEAR(O.REFDATE) = 2020 and month(O.REFDATE) in (10,11,12)


--=========== ATUALIZA PROJETOS EM BRANCO DE ACORDO COM A EMPRESA =================
UPDATE MBS..RECEITASDRE
	SET
		PROJETO = 
				CASE
					WHEN BASE = 'SBOInnovaPA' THEN 'INN-000'
					WHEN BASE = 'SBODL' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBODL.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-003' --SALARIOS E ALIMENTACAO
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-003' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-003' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-003' ELSE PROJETO END
							END
						) END

					WHEN BASE = 'SBOEmpreendimentosRZ' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOEmpreendimentosRZ.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOEmpreendimentosSM' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOEmpreendimentosSM.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END

					WHEN BASE = 'SBOEquilibrium' AND BPLNAME NOT LIKE 'Equilibrium SCP' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOEquilibrium.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-003'
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-003' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-003' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								WHEN (ACCOUNT LIKE '3.1.01.03.02' OR ACCOUNT LIKE '3.3.02.05.11' OR ACCOUNT LIKE '3.3.04.01.01') THEN 'NIC-000' --ICMS ST E MULTAS COMPENSATORIAS PELO ATRASO DAS GUIAS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-003' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOEquilibrium' AND BPLNAME LIKE 'Equilibrium SCP' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOEquilibrium.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),						
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-003'
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'EQU-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'EQU-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'EQU-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOBELACARIOCA' AND BPLNAME LIKE 'BELA%' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOGDSMARCAS.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOINNOVALAB' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOINNOVALAB.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),						
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'INN-002'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'INN-002' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'INN-002' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'INN-002' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOLCA' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOLCA.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS 
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOLICITAACAO' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOLICITAACAO.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.13' OR ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.02.03' OR ACCOUNT LIKE '3.3.02.02.04' OR ACCOUNT LIKE '3.3.02.02.05' OR ACCOUNT LIKE '3.3.02.02.06' OR ACCOUNT LIKE '3.3.02.02.07' OR ACCOUNT LIKE '3.3.02.02.17' OR ACCOUNT LIKE '3.3.02.02.18' OR ACCOUNT LIKE '3.3.02.02.81' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-003'
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS 
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOMW' AND BPLNAME LIKE 'ML Logstica' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOMW.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'INN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'INN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS 
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOMW' AND (BPLNAME LIKE 'MW F%' OR BPLNAME LIKE 'MW D%' OR BPLNAME LIKE 'MW M%') THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOMW.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								WHEN (ACCOUNT LIKE '3.1.01.03.01' OR ACCOUNT LIKE '3.3.01.02.10' OR ACCOUNT LIKE '3.3.02.06.10') THEN 'NIC-000' --IPI S/ VENDAS, ROYALTIES 
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOMW' AND BPLNAME LIKE 'MW SCP' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOMW.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'MW-SCP' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'MW-SCP' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'MW-SCP' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOMW' AND BPLNAME LIKE 'Nutriex Nutracutica' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOMW.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'NIN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'NIN-000'
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'NIN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'NIN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'NIN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'NIN-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOMW' AND BPLNAME LIKE 'XDM' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOMW.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END
						

					WHEN BASE = 'SBOMW' AND BPLNAME LIKE 'XZD' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOMW.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBONutGynMatriz' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBONutGynMatriz.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.13' OR ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.02.03' OR ACCOUNT LIKE '3.3.02.02.04' OR ACCOUNT LIKE '3.3.02.02.05' OR ACCOUNT LIKE '3.3.02.02.06' OR ACCOUNT LIKE '3.3.02.02.07' OR ACCOUNT LIKE '3.3.02.02.17' OR ACCOUNT LIKE '3.3.02.02.18' OR ACCOUNT LIKE '3.3.02.02.81' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04') THEN 'NPH-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'NPH-000'
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'NPH-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'NPH-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'NPH-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'NPH-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBONutriexInd' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBONutriexInd.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'NIC-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'NIC-000'
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'NIC-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'NIC-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'NIC-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								WHEN (ACCOUNT LIKE '3.1.01.03.01' OR ACCOUNT LIKE '3.3.01.02.10' OR ACCOUNT LIKE '3.3.02.06.10') THEN 'NIC-000' --IPI S/ VENDAS, ROYALTIES
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'NIC-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SboOralls' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SboOralls.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'ORA-001'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'ORA-001'
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'ORA-001' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'ORA-001' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'ORA-001' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'ORA-001' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOVidafarma' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOVidafarma.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'INN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'INN-000'
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'INN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'INN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'INN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'INN-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOZ9' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOZ9.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SBOA7' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SBOA7.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-003' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-003' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-003' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-003' ELSE PROJETO END
							END
						) END


					WHEN BASE = 'SboChuaChua' THEN
						CASE WHEN CRIADOR LIKE 'FPW' THEN PROJETO ELSE COALESCE((SELECT TOP 1 K.PROJECT FROM SboChuaChua.[dbo].[JDT1] K WHERE K.TRANSID = TRANSACAO AND K.PROJECT <> ''),
							CASE
								WHEN (ACCOUNT LIKE '3.3.02.01.01' OR ACCOUNT LIKE '3.3.02.01.17' OR ACCOUNT LIKE '3.3.02.01.11' OR ACCOUNT LIKE '3.3.02.01.10' OR ACCOUNT LIKE '3.3.02.01.02' OR ACCOUNT LIKE '3.3.02.01.03' OR ACCOUNT LIKE '3.3.02.01.04' OR ACCOUNT LIKE '3.3.02.01.05' OR ACCOUNT LIKE '3.3.02.01.06' OR ACCOUNT LIKE '3.3.02.01.07' OR ACCOUNT LIKE '3.3.02.01.08' OR ACCOUNT LIKE '3.3.02.01.71' OR ACCOUNT LIKE '3.3.02.07.01' OR ACCOUNT LIKE '3.3.02.07.02' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.07.91' OR ACCOUNT LIKE '3.3.02.05.02' OR ACCOUNT LIKE '3.3.02.05.03' OR ACCOUNT LIKE '3.3.02.05.04' OR ACCOUNT LIKE '3.3.02.05.91') THEN 'GEN-000'
								WHEN (ACCOUNT LIKE '3.3.03.01.01' OR ACCOUNT LIKE '3.3.03.01.02' OR ACCOUNT LIKE '3.3.03.01.03' OR ACCOUNT LIKE '3.3.03.02.01' OR ACCOUNT LIKE '3.3.03.02.02' OR ACCOUNT LIKE '3.3.03.02.03' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.06' OR ACCOUNT LIKE '3.3.03.02.04' OR ACCOUNT LIKE '3.3.03.02.71' OR ACCOUNT LIKE '3.3.03.02.07' OR ACCOUNT LIKE '3.3.03.04.03' OR ACCOUNT LIKE '3.3.03.02.08') THEN 'GEN-000' --DESPESAS/RECEITAS FINANCEIRAS
								WHEN (ACCOUNT LIKE '3.3.02.02.01' OR ACCOUNT LIKE '3.3.02.02.71' OR ACCOUNT LIKE '3.3.02.07.03' OR ACCOUNT LIKE '3.3.02.03.71' OR ACCOUNT LIKE '3.3.04.01.01' OR ACCOUNT LIKE '3.3.02.05.05') THEN 'GEN-000' --IPTU
								WHEN (ACCOUNT LIKE '3.4.01.01.01' OR ACCOUNT LIKE '3.3.02.04.17' OR ACCOUNT LIKE '3.3.02.05.71' OR ACCOUNT LIKE '3.3.02.06.06' OR ACCOUNT LIKE '3.3.01.05.01' OR ACCOUNT LIKE '3.3.01.02.05' OR ACCOUNT LIKE '3.3.02.06.08' OR ACCOUNT LIKE '3.3.04.01.02' OR ACCOUNT LIKE '3.3.01.06.05' OR ACCOUNT LIKE '3.3.01.02.12' OR ACCOUNT LIKE '3.3.02.04.03' OR ACCOUNT LIKE '3.4.01.01.02' OR ACCOUNT LIKE '3.3.01.02.03' OR ACCOUNT LIKE '3.3.04.03.01' OR ACCOUNT LIKE '3.3.01.07.04' OR ACCOUNT LIKE '3.3.04.03.05' OR ACCOUNT LIKE '3.3.01.05.04' OR ACCOUNT LIKE '3.3.01.02.02') THEN 'GEN-000' --IRPJ/CSLL
								WHEN (ACCOUNT LIKE '3.3.02.02.02' OR ACCOUNT LIKE '3.3.02.05.13') THEN 'GEN-000' --DEPRECIACOES + ICMS SOBRE OUTRAS OPERACOES
								WHEN (ACCOUNT LIKE '3.3.01.02.04') THEN 'GEN-003' --MULTA POR ATRASO
								WHEN (ACCOUNT LIKE '3.3.02.04.09') THEN 'GEN-001' --SERVICOS ACCOUNTBEIS
								WHEN (ACCOUNT LIKE '3.1.01.03.01' OR ACCOUNT LIKE '3.3.01.02.10' OR ACCOUNT LIKE '3.3.02.06.10') THEN 'NIC-000' --IPI S/ VENDAS, ROYALTIES 
								ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
							END
						) END

					ELSE CASE WHEN (PROJETO IS NULL OR PROJETO = '') THEN 'GEN-000' ELSE PROJETO END
				END


--====================== ATUALIZA PROJETOS DUPLICADOS NA MESMA EMPRESA ===========================
UPDATE MBS..RECEITASDRE
	SET	PROJETO = 
				CASE
					WHEN (BASE = 'SBOA7') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'GEN-003'
					WHEN (BASE = 'SBODL') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'GEN-003'
					WHEN (BASE = 'SBOBELACARIOCA') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'NIM-000'
					WHEN (BASE = 'SBOINNOVABR') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'NS-003 '
					WHEN (BASE = 'SBOINNOVALAB') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'INN-002'
					WHEN (BASE = 'SBOLICITAACAO') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'GEN-003'
					WHEN (BASE = 'SBOnutgynmatriz' AND PROJETO = 'GEN-000') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'NPH-000'
					WHEN (BASE = 'SBONUTRIEXIND') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'NIC-000'
					WHEN (BASE = 'SBOORALLS') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'ORA-001'
					WHEN (BASE = 'SBOVIDAFARMA') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'INN-000'
					WHEN (BASE = 'SBOZ9') AND (CRIADOR LIKE 'FPW' OR ACCTNAME LIKE 'VALE TRANSP%' OR ACCTNAME LIKE 'ALIMENTAO') THEN 'GEN-000'
					ELSE PROJETO
				END



--====================== ATUALIZA SEGMENTOS POR EMPRESA ===========================
UPDATE MBS..RECEITASDRE
	SET
		SEGMENTO = 
				CASE
					WHEN BASE LIKE 'SBOEQUILIBRIUM'	THEN 'INN/LIC/NUT'
					WHEN BASE IN ('SBOINNOVABR', 'SBOINNOVAPA', 'SBOVIDAFARMA')	THEN 'INNOVA'
					WHEN BASE IN ('SBOA7', 'SBODL', 'SBOINNOVALAB', 'SBOLICITAACAO') THEN 'LICITACAO'
					WHEN BASE IN ('SBOML', 'SBOMW', 'SBONUTGYNMATRIZ', 'SBONUTRIEXIND','SBOLCA','SboChuaChua','SBOBELACARIOCA') THEN 'NUTRIEX'					
					WHEN BASE IN ('SBOEmpLREZENDE', 'SBOEmpreendimentosRZ', 'SBOEmpreendimentosSM', 'SBOInfinix1','SBOInfinix2') THEN 'HOLDING'					
					WHEN BASE IN ('SBOGdsMarcasEU', 'SBOOralls', 'SBORZLaboratorios', 'SBOVZ', 'SBOZ9') THEN 'DIST_LUCROS'					
					ELSE 'GERAL'
				END


--====================== ATUALIZA TIPOS DE DOCUMENTO ===========================
UPDATE MBS..RECEITASDRE
	SET	TRANSTYPE = 
			CASE 
				WHEN TRANSTYPE = '13' THEN 'FAT NF SAIDA'
				WHEN TRANSTYPE = '14' THEN 'DEV NF SAIDA'
				WHEN TRANSTYPE = '15' THEN 'FAT NF ENTREGA'
				WHEN TRANSTYPE = '16' THEN 'DEV NF ENTREGA'
				WHEN TRANSTYPE = '18' THEN 'FAT NF ENTRADA'
				WHEN TRANSTYPE = '19' THEN 'DEV NF ENTRADA'
				WHEN TRANSTYPE = '20' THEN 'REC MERC COMPRAS'
				WHEN TRANSTYPE = '24' THEN 'CONTAS A RECEBER'
				WHEN TRANSTYPE = '25' THEN 'DEPOSITOS'
				WHEN TRANSTYPE = '30' THEN 'LANC CONTABIL MANUAL'
				WHEN TRANSTYPE = '46' THEN 'CONTAS A PAGAR'
				WHEN TRANSTYPE = '59' THEN 'ENTRADA INSUMOS'
				WHEN TRANSTYPE = '60' THEN 'SAIDA INSUMOS'
				WHEN TRANSTYPE = '67' THEN 'TRANSF ESTOQUE'
				WHEN TRANSTYPE = '69' THEN 'NF TRANSPORTE'
				WHEN TRANSTYPE = '162' THEN 'REAVALIACAO ESTOQUE'
				WHEN TRANSTYPE = '202' THEN 'ORDEM PRODUCAO'
				WHEN TRANSTYPE = '203' THEN 'ADIANTAMENTO CONTAS REC'
				WHEN TRANSTYPE = '204' THEN 'ADIANTAMENTO FORNECEDOR'
				WHEN TRANSTYPE = '321' THEN 'RECONCILIACAO INTERNA'
				WHEN TRANSTYPE = '10000071' THEN 'AJUSTE INVENTARIO'
				ELSE TRANSTYPE 
			END


--====================== ATUALIZA CATEGORIAS POR EMPRESA ===========================
UPDATE MBS..RECEITASDRE
	SET	CATEGORIA = 
				CASE
					WHEN CATEGORIA = 1 THEN 'COLIGADA'
					WHEN BASE = 'SBOA7' AND CATEGORIA IN (119, 122, 130, 123, 105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOChuaChua' AND CATEGORIA IN (105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBODL' AND CATEGORIA IN (120, 123, 124, 105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOEmpLREZENDE' AND CATEGORIA IN (120, 123, 124, 105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOEmpreendimentosRZ' AND CATEGORIA IN (105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOEmpreendimentosSM' AND CATEGORIA IN (105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOEquilibrium' AND CATEGORIA IN (120, 123, 124, 105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOGDSMARCAS' AND CATEGORIA IN (120, 123, 124) THEN 'PUBLICO'
					WHEN BASE = 'SBOGdsMarcasEU' AND CATEGORIA IN (105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOInfinix1' AND CATEGORIA IN (120, 123, 124, 105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOInfinix2' AND CATEGORIA IN (120, 123, 124, 105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOInnovaBR' AND CATEGORIA IN (120, 123, 124, 105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOInnovaLab' AND CATEGORIA IN (120, 123, 124, 105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOInnovaPA' AND CATEGORIA IN (105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOLCA' AND CATEGORIA IN (105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOML' AND CATEGORIA IN (105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOMW' AND CATEGORIA IN (120, 123, 124) THEN 'PUBLICO'
					WHEN BASE = 'SBONutGynMatriz' AND CATEGORIA IN (116, 115, 117) THEN 'PUBLICO'
					WHEN BASE = 'SBONutriexInd' AND CATEGORIA IN (122, 125, 126, 105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOOralls' AND CATEGORIA IN (120, 123, 124, 105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBORZLaboratorios' AND CATEGORIA IN (105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOVidafarma' AND CATEGORIA IN (105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOZ9' AND CATEGORIA IN (105, 104, 106) THEN 'PUBLICO'
					WHEN BASE = 'SBOVZ' AND CATEGORIA IN (120, 123, 124, 105, 104, 106) THEN 'PUBLICO'
					ELSE 'PRIVADO'
				END

--================================================================================================
SELECT 
	R.BASE AS BASE
	,COALESCE(R.EMPRESA,'') AS EMPRESA
	,COALESCE(R.[BPLNAME],replace(r.base,'sbo','')) FILIAL
	,R.TRANSTYPE AS TIPO
	,R.TRANSACAO
	,R.BASEREF AS SAPNUM
	,coalesce(mbs.dbo.getnumbers(R.NFNUM),0) NFNUM
	,R.REFDATE AS PERIODO
	,COALESCE(P.NEWIDPROJETO,'RAT000') AS NEW_PROJID
	,COALESCE(P.NEWPROJETO,'RATEIO GERAL') AS NEW_PROJDESC
	,R.VENDEDOR
	,R.SUPERVISOR
	,R.CRIADOR
	,REPLACE(REPLACE(REPLACE(REPLACE(R.LINEMEMO,CHAR(13),' '),CHAR(10),' '),CHAR(9),' '),';',' ') LINEMEMO
	,R.SHORTNAME AS CONTA
	,R.ACCTNAME AS DETALHE
	,R.[USUARIO]
	,R.[CLIENTECOD] 
	,R.[CLIENTENOME] 
	,R.SEGMENTO
	,N0.[DESC] CONTA
	,N1.[DESC] SUBGRUPO
	,N2.[DESC] GRUPO
	--,COALESCE(C.CLASSENAME,'SEM_CLASSIFICACAO') CLASSE
	,R.[CATEGORIA] 
	,case
		when R.TRANSTYPE in ('AJUSTE INVENTARIO','DEV NF ENTRADA','DEV NF SAIDA','FAT NF ENTRADA','FAT NF ENTREGA','FAT NF SAIDA','LANC CONTABIL MANUAL','NF TRANSPORTE','RECONCILIACAO INTERNA','DEV NF ENTREGA') then 'CON/FAT/FIS'
		when R.TRANSTYPE in ('CONTAS A PAGAR','CONTAS A RECEBER','ADIANTAMENTO CONTAS REC','ADIANTAMENTO FORNECEDOR','DEPOSITOS') then 'FIN/TES'
		else 'GERAL'
	 end ESTATISTICA
	,R.DEBCRED
	,SUM(CAST(R.DEBIT AS FLOAT)) AS DEBITO
	,SUM(CAST(R.CREDIT AS FLOAT)) AS CREDITO
	,SUM(CAST(R.DEBIT + R.CREDIT AS FLOAT)) AS SALDO
FROM 
	MBS..RECEITASDRE R LEFT JOIN 
	MBS..PROJETOS P ON P.OLDIDPROJETO = R.PROJETO LEFT JOIN
	--MBS..CLASSES C ON C.CLASSEID = R.NIVEL3 LEFT JOIN
	MBS..DRE_NIVEL0 N0 ON N0.ID = R.NIVEL0 LEFT JOIN
	MBS..DRE_NIVEL1 N1 ON N1.ID = R.NIVEL1 LEFT JOIN
	MBS..DRE_NIVEL2 N2 ON N2.ID = R.NIVEL2
WHERE
	R.TRANSCODE NOT LIKE 'ESP' and (left(R.SHORTNAME,1) = '3' or left(R.SHORTNAME,1) = '5')
GROUP BY
	 R.BASE
	,COALESCE(R.EMPRESA,'')
	,COALESCE(R.[BPLNAME],replace(r.base,'sbo',''))
	,R.DEBCRED
	,R.REFDATE
	,R.SHORTNAME
	,R.TRANSACAO
	,R.BASEREF
	,R.NFNUM
	,R.TRANSTYPE
	,R.ACCTNAME
	,COALESCE(P.NEWIDPROJETO,'RAT000')
	,COALESCE(P.NEWPROJETO,'RATEIO GERAL')
	,R.VENDEDOR
	,R.SUPERVISOR
	,R.CRIADOR
	,REPLACE(REPLACE(REPLACE(REPLACE(R.LINEMEMO,CHAR(13),' '),CHAR(10),' '),CHAR(9),' '),';',' ')
	,R.[USUARIO]
	,R.[CLIENTECOD] 
	,R.[CLIENTENOME] 
	,R.[CATEGORIA] 
		,case
		when R.TRANSTYPE in ('AJUSTE INVENTARIO','DEV NF ENTRADA','DEV NF SAIDA','FAT NF ENTRADA','FAT NF ENTREGA','FAT NF SAIDA','LANC CONTABIL MANUAL','NF TRANSPORTE','RECONCILIACAO INTERNA','DEV NF ENTREGA') then 'CON/FAT/FIS'
		when R.TRANSTYPE in ('CONTAS A PAGAR','CONTAS A RECEBER','ADIANTAMENTO CONTAS REC','ADIANTAMENTO FORNECEDOR','DEPOSITOS') then 'FIN/TES'
		else 'GERAL'
	 end
	,R.SEGMENTO
	--,C.CLASSENAME
	,N0.[DESC]
	,N1.[DESC]
	,N2.[DESC]
